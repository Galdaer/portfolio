exclude_dirs:
  - tests
  - data/synthetic
  - .venv
  - archive
  - actions-runners
  - services/user/whisperlive

skips:
  - B101 # assert_used (legitimate in tests and validation)
  - B603 # subprocess_without_shell_equals_true (controlled usage in healthcare scripts)

tests:
  - B201 # flask_debug_true
  - B301 # pickle usage (potential security risk)
  - B501 # request_with_no_cert_validation
  - B506 # yaml_load_unsafe (use yaml.safe_load)
  - B602 # subprocess_popen_with_shell_equals_true
  - B608 # hardcoded_sql_expressions
  - B703 # django_mark_safe (if Django used)
  # Healthcare AI specific security checks
  - B105 # hardcoded_password_string (critical for PHI protection)
  - B106 # hardcoded_password_funcarg
  - B107 # hardcoded_password_default
  - B108 # hardcoded_tmp_directory
  - B110 # try_except_pass (healthcare errors should not be silenced)
  - B112 # try_except_continue (healthcare errors should not be silenced)
  - B201 # flask_debug_true (never in healthcare production)
  - B601 # paramiko_calls (check SSH usage in medical data transfers)
  - B605 # start_process_with_a_shell (validate shell usage in downloaders)

# Healthcare AI specific security configuration
severity:
  - high
  - medium

# PHI protection patterns
patterns:
  - hardcoded_password_string:
      word_list:
        ["password", "pass", "pwd", "token", "secret", "key", "api_key"]
  - hardcoded_bind_all_interfaces:
      message: "Healthcare services should not bind to all interfaces (0.0.0.0)"
  - B607 # start_process_with_partial_path (ensure full paths in medical scripts)
  - B609 # linux_commands_wildcard_injection (prevent injection in medical data processing)
  - B611 # subprocess_without_shell_equals_true (validate subprocess usage)
  - B701 # jinja2_autoescape_false (prevent XSS in healthcare templates)
  - B702 # use_of_mako_templates (check template security)

# Healthcare-specific security patterns
assert_used:
  skips: [] # Keep assert checking for medical validation code

# Enable additional healthcare security checks
hardcoded_password_string:
  word_list:
    [
      "password",
      "pass",
      "passwd",
      "pwd",
      "secret",
      "token",
      "key",
      "auth",
      "api_key",
      "access_token",
      "fhir_token",
      "medical_api",
      "phi_key",
      "patient_id",
      "mrn",
      "ssn",
      "dob",
      "hipaa",
    ]

# Medical-mirrors specific checks (based on PR #31 issues)
hardcoded_tmp_directory:
  # Ensure temp directories for medical data are properly secured
  tmp_dirs: ["/tmp", "/var/tmp", "/dev/shm"]

# Database security for healthcare
hardcoded_sql_expressions:
  # Check for SQL injection risks in medical data queries
  confidence: HIGH

# Process security for medical data downloaders
subprocess_without_shell_equals_true:
  # Medical data downloaders should use secure subprocess calls
  confidence: MEDIUM
