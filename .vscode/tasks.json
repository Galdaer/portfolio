{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Run All Linting",
            "group": "build",
            "type": "shell",
            "command": "make",
            "args": [
                "lint"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$python",
                "$eslint-stylish"
            ]
        },
        {
            "label": "MyPy (Healthcare API only)",
            "group": "build",
            "type": "shell",
            "command": "mypy",
            "args": [
                "--config-file",
                "mypy.ini",
                "services/user/healthcare-api"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Quick Lint Check",
            "group": "build",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Running quick lint check...' && flake8 --select=E9,F63,F7,F82 --show-source --statistics src/ && echo '‚úÖ Quick lint passed'"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": false,
                "reveal": "silent",
                "focus": false,
                "panel": "shared"
            }
        },
        {
            "label": "MyPy Type Check",
            "group": "build",
            "type": "shell",
            "command": "mypy",
            "args": [
                "."
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Auto-fix Linting Issues",
            "group": "build",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîß Auto-fixing linting issues...' && black src/ tests/ && isort src/ tests/ && echo '‚úÖ Auto-fix complete'"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Test LangChain Agent Fix",
            "group": "test",
            "type": "shell",
            "command": "python3",
            "args": [
                "test_langchain_fix.py"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared",
                "focus": true
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Debug MCP Connection",
            "group": "test",
            "type": "shell",
            "command": "python3",
            "args": [
                "-c",
                "import asyncio; from core.mcp.direct_mcp_client import DirectMCPClient; asyncio.run(DirectMCPClient().debug_connection())"
            ],
            "options": {
                "cwd": "${workspaceFolder}/services/user/healthcare-api"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Build Healthcare API",
            "group": "build",
            "type": "shell",
            "command": "make",
            "args": [
                "healthcare-api-build"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Test Ollama Connection",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Testing Ollama connection...' && curl -s http://localhost:11434/api/version && echo '‚úÖ Ollama connection successful' || echo '‚ùå Ollama connection failed'"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Test LangChain Agent Connection",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "cd services/user/healthcare-api && OLLAMA_URL=http://localhost:11434 python3 -c \"import sys; sys.path.append('/home/intelluxe/services/user/healthcare-api'); from core.langchain.agents import HealthcareLangChainAgent; from core.mcp.direct_mcp_client import DirectMCPClient; mcp_client = DirectMCPClient(); agent = HealthcareLangChainAgent(mcp_client); print('‚úÖ LangChain agent initialized successfully')\""
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Debug MCP Tool Connection",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "cd services/user/healthcare-api && python3 -c \"import asyncio; import sys; sys.path.append('/home/intelluxe/services/user/healthcare-api'); from core.mcp.direct_mcp_client import DirectMCPClient; async def test(): client = DirectMCPClient(); result = await client.call_tool('search-pubmed', {'query': 'test'}); print(f'MCP result: {result}'); asyncio.run(test())\""
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Validate Healthcare Environment",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Healthcare Environment Validation:' && echo 'OLLAMA_URL:' $OLLAMA_URL && echo 'Testing Ollama...' && curl -s http://localhost:11434/api/version | head -1 && echo 'Testing healthcare-api import...' && cd services/user/healthcare-api && python3 -c 'from core.langchain.agents import HealthcareLangChainAgent; print(\"‚úÖ Import successful\")' && echo '‚úÖ Healthcare environment validation complete'"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Run Integration Smoke Tests",
            "group": "test",
            "type": "shell",
            "command": "python3",
            "args": [
                "scripts/run_integration_tests.py"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Monitor Open WebUI Healthcare Integration",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Monitoring Open WebUI Healthcare Integration...' && echo 'Watching logs for healthcare agent activity:' && echo 'healthcare_system.log and agent_medical_search.log' && echo 'Make a medical query in Open WebUI now...' && tail -f logs/healthcare_system.log logs/agent_medical_search.log"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared",
                "focus": true
            },
            "isBackground": true
        },
        {
            "label": "Test Medical Search Agent Direct",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Testing Medical Search Agent Direct (bypass Open WebUI)...' && cd services/user/healthcare-api && python3 -c \"import sys; sys.path.append('/home/intelluxe/services/user/healthcare-api'); from agents.medical_search import MedicalLiteratureSearchAssistant; from core.mcp.direct_mcp_client import DirectMCPClient; mcp_client = DirectMCPClient(); agent = MedicalLiteratureSearchAssistant(mcp_client); print('‚úÖ Medical search agent loaded successfully'); print('Agent type:', type(agent)); print('MCP client:', type(mcp_client))\""
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Check Healthcare API Request Routing",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Checking Healthcare API Request Routing...' && echo 'Analyzing recent healthcare system logs for request patterns:' && echo '--- Medical/Search Keywords ---' && grep -i -E '(medical|search|agent|pubmed|clinical)' logs/healthcare_system.log | tail -10 && echo '--- Request Processing ---' && grep -i -E '(request|routing|intent|classification)' logs/healthcare_system.log | tail -10 && echo '--- Agent Activity ---' && grep -i 'agent' logs/healthcare_system.log | tail -5"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Test Open WebUI Connection",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Testing Open WebUI Connection...' && echo 'Testing healthcare API endpoint:' && curl -s http://localhost:8000/health && echo '' && echo 'Testing Open WebUI chat endpoint (if available):' && curl -s -X POST http://localhost:8000/v1/chat/completions -H 'Content-Type: application/json' -d '{\"model\":\"healthcare\",\"messages\":[{\"role\":\"user\",\"content\":\"test medical query\"}]}' | head -200 && echo ''"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Debug Healthcare Agent Registration",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Debugging Healthcare Agent Registration...' && cd services/user/healthcare-api && python3 -c \"import sys; sys.path.append('/home/intelluxe/services/user/healthcare-api'); try: from core.agent_coordinator import AgentCoordinator; coordinator = AgentCoordinator(); print('Available agents:', coordinator.list_agents()); except ImportError as e: print('AgentCoordinator not found:', e); print('Checking for agent imports...'); import os; print('Agent files:', [f for f in os.listdir('agents') if f.endswith('.py')]); except Exception as e: print('Error:', e)\""
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Comprehensive Healthcare Stack Test",
            "group": "test",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Comprehensive Healthcare Stack Test...' && echo '1. Testing Ollama...' && curl -s http://localhost:11434/api/version && echo '‚úÖ Ollama OK' && echo '2. Testing MCP tools...' && cd services/user/healthcare-api && python3 -c \"import asyncio; from core.mcp.direct_mcp_client import DirectMCPClient; asyncio.run(DirectMCPClient().call_tool('search-pubmed', {'query': 'test'}))\" && echo '‚úÖ MCP OK' && echo '3. Testing Healthcare API...' && curl -s http://localhost:8000/health && echo '‚úÖ API OK' && echo '4. Testing Agent Import...' && python3 -c \"from agents.medical_search import MedicalLiteratureSearchAssistant; print('‚úÖ Agent import OK')\" && echo 'üéâ All healthcare stack components functional'"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "panel": "shared"
            },
            "problemMatcher": "$python"
        },
        {
            "label": "Quick Lint Check",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "echo 'üîç Running quick lint check...' && flake8 --select=E9,F63,F7,F82 --show-source --statistics src/ && echo '‚úÖ Quick lint passed'"
            ],
            "group": "build"
        }
    ]
}