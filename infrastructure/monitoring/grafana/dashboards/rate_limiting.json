{
    "__inputs": [
        {
            "name": "DS_JSONAPI",
            "label": "JSON API Datasource",
            "description": "Datasource that calls the /admin/rate-limit/stats endpoint",
            "type": "datasource",
            "pluginId": "marcusolsson-json-datasource",
            "pluginName": "JSON API"
        }
    ],
    "__requires": [
        {
            "type": "grafana",
            "id": "grafana",
            "name": "Grafana",
            "version": "9.0.0"
        },
        {
            "type": "panel",
            "id": "stat",
            "name": "Stat",
            "version": "1"
        },
        {
            "type": "panel",
            "id": "table",
            "name": "Table",
            "version": "1"
        },
        {
            "type": "panel",
            "id": "timeseries",
            "name": "Time series",
            "version": "1"
        }
    ],
    "title": "Healthcare API Rate Limiting",
    "uid": "health-rate-limits",
    "timezone": "browser",
    "schemaVersion": 37,
    "version": 1,
    "refresh": "10s",
    "tags": [
        "healthcare",
        "rate-limiting"
    ],
    "panels": [
        {
            "type": "stat",
            "title": "Allowed Requests",
            "gridPos": {
                "h": 4,
                "w": 6,
                "x": 0,
                "y": 0
            },
            "options": {
                "reduceOptions": {
                    "calcs": [
                        "last"
                    ],
                    "fields": "",
                    "values": false
                },
                "orientation": "horizontal"
            },
            "targets": [
                {
                    "refId": "A",
                    "datasource": {
                        "type": "marcusolsson-json-datasource",
                        "uid": "${DS_JSONAPI}"
                    },
                    "method": "GET",
                    "urlPath": "/admin/rate-limit/stats",
                    "queryParams": "",
                    "field": "summary.allowed"
                }
            ]
        },
        {
            "type": "stat",
            "title": "Denied Requests",
            "gridPos": {
                "h": 4,
                "w": 6,
                "x": 6,
                "y": 0
            },
            "options": {
                "reduceOptions": {
                    "calcs": [
                        "last"
                    ],
                    "fields": "",
                    "values": false
                },
                "orientation": "horizontal"
            },
            "targets": [
                {
                    "refId": "B",
                    "datasource": {
                        "type": "marcusolsson-json-datasource",
                        "uid": "${DS_JSONAPI}"
                    },
                    "method": "GET",
                    "urlPath": "/admin/rate-limit/stats",
                    "field": "summary.denied"
                }
            ]
        },
        {
            "type": "stat",
            "title": "Emergency Bypass Activations",
            "gridPos": {
                "h": 4,
                "w": 6,
                "x": 12,
                "y": 0
            },
            "options": {
                "reduceOptions": {
                    "calcs": [
                        "last"
                    ],
                    "fields": "",
                    "values": false
                },
                "orientation": "horizontal"
            },
            "targets": [
                {
                    "refId": "C",
                    "datasource": {
                        "type": "marcusolsson-json-datasource",
                        "uid": "${DS_JSONAPI}"
                    },
                    "method": "GET",
                    "urlPath": "/admin/rate-limit/stats",
                    "field": "summary.emergency_bypass"
                }
            ]
        },
        {
            "type": "stat",
            "title": "Allow Rate",
            "gridPos": {
                "h": 4,
                "w": 6,
                "x": 18,
                "y": 0
            },
            "options": {
                "reduceOptions": {
                    "calcs": [
                        "last"
                    ],
                    "fields": "",
                    "values": false
                },
                "orientation": "horizontal",
                "colorMode": "value",
                "graphMode": "none",
                "textMode": "auto"
            },
            "targets": [
                {
                    "refId": "D",
                    "datasource": {
                        "type": "marcusolsson-json-datasource",
                        "uid": "${DS_JSONAPI}"
                    },
                    "method": "GET",
                    "urlPath": "/admin/rate-limit/stats",
                    "field": "summary.allow_rate"
                }
            ]
        },
        {
            "type": "table",
            "title": "Role/Type Breakdown (Net Allowed - Denied)",
            "gridPos": {
                "h": 10,
                "w": 12,
                "x": 0,
                "y": 4
            },
            "options": {
                "showHeader": true
            },
            "targets": [
                {
                    "refId": "E",
                    "datasource": {
                        "type": "marcusolsson-json-datasource",
                        "uid": "${DS_JSONAPI}"
                    },
                    "method": "GET",
                    "urlPath": "/admin/rate-limit/stats",
                    "rootSelector": "breakdown",
                    "type": "table"
                }
            ]
        },
        {
            "type": "table",
            "title": "Config Metadata",
            "gridPos": {
                "h": 4,
                "w": 12,
                "x": 12,
                "y": 4
            },
            "options": {
                "showHeader": true
            },
            "targets": [
                {
                    "refId": "F",
                    "datasource": {
                        "type": "marcusolsson-json-datasource",
                        "uid": "${DS_JSONAPI}"
                    },
                    "method": "GET",
                    "urlPath": "/admin/rate-limit/stats",
                    "format": "json",
                    "field": "policy_version"
                }
            ]
        }
    ],
    "templating": {
        "list": []
    },
    "time": {
        "from": "now-15m",
        "to": "now"
    },
    "timepicker": {
        "refresh_intervals": [
            "5s",
            "10s",
            "30s",
            "1m",
            "5m"
        ]
    }
}